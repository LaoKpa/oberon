<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Reconstruction algorithm | Order book events reconstruction from empirical data</title>
  <meta name="description" content="2 Reconstruction algorithm | Order book events reconstruction from empirical data" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Reconstruction algorithm | Order book events reconstruction from empirical data" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Reconstruction algorithm | Order book events reconstruction from empirical data" />
  
  
  

<meta name="author" content="Petr Fedorov" />


<meta name="date" content="2020-04-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="results.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#continous-time-double-auction-and-lob"><i class="fa fa-check"></i><b>1.1</b> Continous-time double auction and LOB</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#available-data-sets"><i class="fa fa-check"></i><b>1.2</b> Available data sets</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reconstruction-algorithm.html"><a href="reconstruction-algorithm.html"><i class="fa fa-check"></i><b>2</b> Reconstruction algorithm</a><ul>
<li class="chapter" data-level="2.1" data-path="reconstruction-algorithm.html"><a href="reconstruction-algorithm.html#basic-tools"><i class="fa fa-check"></i><b>2.1</b> Basic Tools</a></li>
<li class="chapter" data-level="2.2" data-path="reconstruction-algorithm.html"><a href="reconstruction-algorithm.html#order-and-trade"><i class="fa fa-check"></i><b>2.2</b> Order and Trade</a></li>
<li class="chapter" data-level="2.3" data-path="reconstruction-algorithm.html"><a href="reconstruction-algorithm.html#limit-order-book-lob"><i class="fa fa-check"></i><b>2.3</b> Limit Order Book (LOB)</a></li>
<li class="chapter" data-level="2.4" data-path="reconstruction-algorithm.html"><a href="reconstruction-algorithm.html#example-of-lob"><i class="fa fa-check"></i><b>2.4</b> Example of LOB</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>3</b> Results</a><ul>
<li class="chapter" data-level="3.1" data-path="results.html"><a href="results.html#fragments-of-data-streams"><i class="fa fa-check"></i><b>3.1</b> Fragments of data streams</a><ul>
<li class="chapter" data-level="3.1.1" data-path="results.html"><a href="results.html#bitstamp-orders"><i class="fa fa-check"></i><b>3.1.1</b> Bitstamp Orders</a></li>
<li class="chapter" data-level="3.1.2" data-path="results.html"><a href="results.html#bitstamp-trades"><i class="fa fa-check"></i><b>3.1.2</b> Bitstamp Trades</a></li>
<li class="chapter" data-level="3.1.3" data-path="results.html"><a href="results.html#bitfinex-orders"><i class="fa fa-check"></i><b>3.1.3</b> Bitfinex Orders</a></li>
<li class="chapter" data-level="3.1.4" data-path="results.html"><a href="results.html#bitfinex-trades"><i class="fa fa-check"></i><b>3.1.4</b> Bitfinex Trades</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>4</b> Discussion</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Order book events reconstruction from empirical data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reconstruction-algorithm" class="section level1">
<h1><span class="header-section-number">2</span> Reconstruction algorithm</h1>
<p>First we need to define what we reconstruct. Surprisingly, the concept of order and operations of a continous double auction are rather complicated things if one attempts to define them rigorously! Consider, for example, a definition given in the book <span class="citation">(Bouchaud and Bonart 2018)</span>:</p>
<blockquote>
<p>An order is a commitment, declared at a given submission time, to buy or sell a given volume of an asset at no worse than a given price. An order <span class="math inline">\(x\)</span> is thus described by four attributes:</p>
<ul>
<li>its sign (or direction) <span class="math inline">\(\epsilon = \pm 1\)</span>, (<span class="math inline">\(\epsilon_x = +1\)</span> for buy orders; <span class="math inline">\(\epsilon_x = −1\)</span> for sell orders),</li>
<li>its price <span class="math inline">\(p_x\)</span> ,</li>
<li>its volume <span class="math inline">\(v_x &gt; 0\)</span>, and</li>
<li>its submission time <span class="math inline">\(t_x\)</span>.</li>
</ul>
<p>We introduce the succinct notation <span class="math inline">\(x := (\epsilon_x , p_x ,v_x, t_x )\)</span>.</p>
</blockquote>
<p><span class="citation">(Bouchaud and Bonart 2018)</span> then continues with a description of what they call The Trade-Matching Algorithm:</p>
<blockquote>
<p>Whenever a trader submits a buy (respectively, sell) order <span class="math inline">\(x\)</span>, an LOB’s <em>trade-matching algorithm</em> checks whether it is possible for <span class="math inline">\(x\)</span> to match to existing sell (respectively,buy)orders <span class="math inline">\(y\)</span> such that <span class="math inline">\(p_y \leq p_x\)</span> (respectively, <span class="math inline">\(p_y \geq p_x\)</span>). If so, the matching occurs immediately and the relevant traders perform a trade for the agreed amount at the agreed price. Any portion of <span class="math inline">\(x\)</span> that does not match instead becomes active at the price <span class="math inline">\(p_x\)</span>, and it remains active until either it matches to an incoming sell (respectively, buy) order or it is cancelled. Cancellation usually occurs when the owner of an order no longer wishes to offer a trade at the stated price.</p>
</blockquote>
<p>It might not be obvious, but above definition and description are incomplete:</p>
<ul>
<li><p>According to the definition, an order <span class="math inline">\(x\)</span> seems to be an immutable entity. But according to the Trade-Matching algorithm, a portion of <span class="math inline">\(x\)</span> may become ‘active’ and it is not clear how the quality of being ‘active’ is different from the mere existence of submitted orders,</p></li>
<li><p>At what price the trade is performed - <span class="math inline">\(p_x\)</span> or <span class="math inline">\(p_y\)</span> - is not explicitly stated,</p></li>
<li><p>It is not stated what will happen if <span class="math inline">\(v_x \leq v_y\)</span>, etc.</p></li>
</ul>
<p>Below we propose stricter definitions that address these and the other similar issues while staying as close as possible to <span class="citation">(Bouchaud and Bonart 2018)</span>.</p>
<div id="basic-tools" class="section level2">
<h2><span class="header-section-number">2.1</span> Basic Tools</h2>

<div class="definition">
<p><span id="def:support" class="definition"><strong>Definition 2.1  (Support)  </strong></span>Suppose <span class="math inline">\(X \subset \mathbb{R}\)</span> and <span class="math inline">\(f : X \mapsto \mathbb{R}\)</span>. The support of <span class="math inline">\(f\)</span> is defined as the closure of the subset of <span class="math inline">\(X\)</span> where <span class="math inline">\(f\)</span> is non-zero:
<span class="math display">\[
    \text{supp}(f) = \overline{\{x : x \in X, f(x) \neq 0 \}}
  \]</span></p>
</div>


<div class="definition">
<p><span id="def:piecewise-constant" class="definition"><strong>Definition 2.2  (Piecewise Constant Function)  </strong></span>A function <span class="math inline">\(f : \mathbb{R} \mapsto \mathbb{R}\)</span> is called a piecewise constant function if it can be written as
<span class="math display">\[ 
  f(t) = \sum_{T_k \in \mathcal{T} } f_k \mathbf{1}_{T_k}(t)
\]</span>
where</p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\(\mathcal{T} = \{T_k\}_{k=1}^{K}\)</span> is a set of proper intervals of <span class="math inline">\(\mathbb{R}\)</span> with endpoints <span class="math inline">\(t_{k,1} \in \mathbb{R}\)</span>, <span class="math inline">\(t_{k,2} \in \mathbb{R} \cup \{+\infty\}\)</span>, <span class="math inline">\(t_{k,1} &lt; t_{k,2}\)</span> such that <span class="math inline">\(\forall k_1 \neq k_2 : T_{k_1} \cap T_{k_2} = \emptyset\)</span>,</p></li>
<li><span class="math inline">\(\mathbf{1}_{T_k}(\cdot)\)</span> is an indicator function of interval <span class="math inline">\(T_k\)</span>:
<span class="math display">\[
\mathbf{1}_{T_k}(t) = \begin{cases} 1, &amp; t \in T_k \\ 0, &amp; t \not \in T_k  \end{cases}
\]</span></li>
<li><span class="math inline">\(f_k \in \mathbb{R}\)</span> are constants called <em>function values</em> such that <span class="math inline">\(\forall k_1 \neq k_2 : f_{k_1} \neq f_{k_2}\)</span>
</div></li>
</ol>
<p>All piecewise constant functions we use hereafter must also have either left or right (or both) limits at every point of their domains. So in our definition of piecewise constant function set <span class="math inline">\(\mathcal{T}\)</span> does not include degenerate intervals.</p>

<div class="definition">
<p><span id="def:volume-function" class="definition"><strong>Definition 2.3  (Volume Function)  </strong></span>A function <span class="math inline">\(v : \mathbb{R} \mapsto \mathbb{R}_{\geq 0}\)</span> or <span class="math inline">\(v : \mathbb{R} \mapsto \mathbb{R}_{\leq 0}\)</span> such that</p>
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(v(\cdot)\)</span> is a piecewise constant function as defined by <a href="reconstruction-algorithm.html#def:piecewise-constant">2.2</a> with values in the set <span class="math inline">\(\{ n v_0 : n \in \mathbb{Z}\setminus \{0\} \}\)</span> where <span class="math inline">\(v_0\)</span> is a constant called <em>lot size</em>,</li>
<li><span class="math inline">\(v(\cdot)\)</span> is either càdlàg or càglàd at each point of discontinuity</li>
</ol>
is called a <em>volume function</em>.
</div>


<div class="definition">
<p><span id="def:fill-volume" class="definition"><strong>Definition 2.4  (Filled Volume)  </strong></span>Suppose a volume function <span class="math inline">\(v(t)\)</span> as defined by <a href="reconstruction-algorithm.html#def:volume-function">2.3</a> is given. The function
<span class="math display">\[
  f_{v}(t) = \lim_{t^{&#39;} \uparrow t} v(t^{&#39;}) - v(t)
  \]</span> is called a <em>filled volume</em> at time <span class="math inline">\(t\)</span>.</p>
</div>


<div class="definition">
<p><span id="def:amended-volume" class="definition"><strong>Definition 2.5  (Amended Volume)  </strong></span>Suppose a volume function <span class="math inline">\(v(t)\)</span> as defined by <a href="reconstruction-algorithm.html#def:volume-function">2.3</a> is given. The function
<span class="math display">\[
  a_{v}(t) = v(t) - \lim_{t^{&#39;} \downarrow t} v(t^{&#39;})
\]</span> is called an <em>amended</em> volume at time <span class="math inline">\(t\)</span>.</p>
</div>

<p>Note that <span class="math inline">\(\text{supp}(f_{v})\)</span> is a set of càdlàg discontinuity points of <span class="math inline">\(v(t)\)</span> while <span class="math inline">\(\text{supp}(a_{v})\)</span> is a set of càglàd discontinuity points of <span class="math inline">\(v(t)\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">as_hux</span>(sot[<span class="kw">order</span>(t),</a>
<a class="sourceLine" id="cb1-2" title="2">           .( <span class="st">`</span><span class="dt">#</span><span class="st">`</span>=.I,</a>
<a class="sourceLine" id="cb1-3" title="3">              <span class="st">`</span><span class="ch">\\</span><span class="dt">(i</span><span class="ch">\\</span><span class="dt">)</span><span class="st">`</span>=i,</a>
<a class="sourceLine" id="cb1-4" title="4">              <span class="st">`</span><span class="ch">\\</span><span class="dt">(n</span><span class="ch">\\</span><span class="dt">)</span><span class="st">`</span>=n,</a>
<a class="sourceLine" id="cb1-5" title="5">              <span class="st">`</span><span class="ch">\\</span><span class="dt">(t^i_n</span><span class="ch">\\</span><span class="dt">)</span><span class="st">`</span>=<span class="kw">format</span>(time_<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>t, <span class="st">&quot;%H:%M:%OS1&quot;</span>),</a>
<a class="sourceLine" id="cb1-6" title="6">              <span class="st">`</span><span class="ch">\\</span><span class="dt">(e^i_n</span><span class="ch">\\</span><span class="dt">)</span><span class="st">`</span>=e,</a>
<a class="sourceLine" id="cb1-7" title="7">              <span class="st">`</span><span class="ch">\\</span><span class="dt">(p^i_n</span><span class="ch">\\</span><span class="dt">)</span><span class="st">`</span>=p,</a>
<a class="sourceLine" id="cb1-8" title="8">              <span class="st">`</span><span class="ch">\\</span><span class="dt">(v^i_n</span><span class="ch">\\</span><span class="dt">)</span><span class="st">`</span>=v,</a>
<a class="sourceLine" id="cb1-9" title="9">              <span class="st">`</span><span class="ch">\\</span><span class="dt">(f^i_n</span><span class="ch">\\</span><span class="dt">)</span><span class="st">`</span>=f,</a>
<a class="sourceLine" id="cb1-10" title="10">              volume.decrease, </a>
<a class="sourceLine" id="cb1-11" title="11">               <span class="st">`</span><span class="ch">\\</span><span class="dt">(</span><span class="ch">\\</span><span class="dt">Delta v^i_n </span><span class="ch">\\</span><span class="dt">)</span><span class="st">`</span>=<span class="kw">fifelse</span>(v<span class="op">*</span>volume.decrease <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>n <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>, volume.decrease, <span class="ot">NA_real_</span>)</a>
<a class="sourceLine" id="cb1-12" title="12">                 )]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="st">  </span><span class="kw">add_colnames</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="st">  </span><span class="kw">set_align</span>(everywhere, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="st">&#39;center&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="st">  </span><span class="kw">set_align</span>(<span class="dv">1</span>, <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">8</span>), <span class="st">&#39;right&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="st">  </span><span class="kw">set_right_border</span>(everywhere,<span class="dv">1</span>, <span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="st">  </span><span class="kw">set_caption</span>(<span class="st">&#39;(#tab:example-order-table) The sample order table contains information about six limit orders, three market orders and six trades.&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="st">  </span><span class="kw">set_caption_pos</span>(<span class="st">&quot;topleft&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="st">  </span><span class="kw">set_width</span>(<span class="fl">0.9</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="st">  </span><span class="kw">set_position</span>(<span class="st">&quot;left&quot;</span>)</a></code></pre></div>

<div class="definition">
<p><span id="def:price-function" class="definition"><strong>Definition 2.6  (Price Function)  </strong></span>A function <span class="math inline">\(p : \mathbb{R} \mapsto \mathbb{R}_{\geq 0}\)</span> such that</p>
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(p(\cdot)\)</span> is a piecewise constant function as defined by <a href="reconstruction-algorithm.html#def:piecewise-constant">2.2</a> with values in the set <span class="math inline">\(\{ n \vartheta : n \in \mathbb{Z}\setminus \{0\} \}\)</span> where <span class="math inline">\(\vartheta\)</span> is a constant called <em>tick size</em></li>
<li><span class="math inline">\(p(\cdot)\)</span> is a càglàd at each point of discontinuity</li>
</ol>
is called a <em>price function</em>.
</div>

<p>The lot size <span class="math inline">\(v_0\)</span> and tick size <span class="math inline">\(\vartheta\)</span> are collectively called <em>resolution parameters</em>.</p>
</div>
<div id="order-and-trade" class="section level2">
<h2><span class="header-section-number">2.2</span> Order and Trade</h2>
<p>Hereafter is assumed that a single asset is traded and a single currency is used.</p>

<div class="definition">
<span id="def:order" class="definition"><strong>Definition 2.7  (Order)  </strong></span>Suppose that <span class="math inline">\(i \in \mathbb{N}\)</span> is an <em>unique order identification</em>, <span class="math inline">\(v^i(t)\)</span> is a volume function as defined by <a href="reconstruction-algorithm.html#def:volume-function">2.3</a>, <span class="math inline">\(p^i(t)\)</span> is a price function as defined by <a href="reconstruction-algorithm.html#def:price-function">2.6</a> such that <span class="math display">\[\text{supp}\,(v^i) = \text{supp}\,(p^i)\]</span> Then a vector-valued function <span class="math inline">\(o^i : \mathbb{R} \mapsto \mathbb{R}_{&gt;0} \times \mathbb{R}\)</span> representing a commitment to buy or sell a given volume <span class="math inline">\(v^i(t)\)</span> of an asset at no worse than a given price <span class="math inline">\(p^i(t)\)</span> at a particular time <span class="math inline">\(t\)</span> with a closed form <span class="math display">\[o^i(t) = (p^i(t), v^i(t))\]</span> is called an <em>order</em>. If <span class="math inline">\(\forall t : v^i(t) \in \mathbb{R}_{\leq 0}\)</span> the order is a commitment to <em>sell</em> and is also called a <em>sell order</em>. If <span class="math inline">\(\forall t : v^i(t) \in \mathbb{R}_{\geq 0}\)</span> the order is a commitment to <em>buy</em> and is also called a <em>buy order</em>.
</div>

<p>It should be clear from the definition above that an order is a <a href="https://www.investopedia.com/terms/l/limitorder.asp">limit order</a> and without further qualifications (i.e. a market order, a stop order etc), an order always means a limit order.</p>
<p>Now we can define</p>

<div class="definition">
<span id="def:order-volume" class="definition"><strong>Definition 2.8  (Order Volume)  </strong></span>The function <span class="math inline">\(v^i(t)\)</span> in definition <a href="reconstruction-algorithm.html#def:order">2.7</a> is called an <em>order volume</em>.
</div>


<div class="definition">
<span id="def:order-price" class="definition"><strong>Definition 2.9  (Order Price)  </strong></span>The function <span class="math inline">\(p^i(t)\)</span> in definition <a href="reconstruction-algorithm.html#def:order">2.7</a> is called an <em>order price</em>.
</div>


<div class="definition">
<p><span id="def:trade" class="definition"><strong>Definition 2.10  (Trade)  </strong></span>Suppose an order <span class="math inline">\(o^i(t)\)</span> is given and <span class="math inline">\(\exists t_j : f^i(t_j) \neq 0\)</span>. Then a tuple <span class="math display">\[(t_j, i,p^i(t_j), f_{v^i}(t_j))\]</span> is called a <em>trade</em>. If <span class="math inline">\(f_{v^i}(t_j) &lt; 0\)</span> or, equivalently, <span class="math inline">\(i\)</span> is a sell order, then the trade is a buy trade. Otherwise it is a sell trade.</p>
</div>

<p>An order can be conveniently represented in the form of a order table defined by <a href="reconstruction-algorithm.html#def:order-table">2.11</a>.</p>

<div class="definition">
<p><span id="def:order-table" class="definition"><strong>Definition 2.11  (Order Table)  </strong></span>
An <em>order table</em> is a set of tuples <span class="math display">\[\{(i, n, t^i_n,e^i_n, p^i_n, v^i_n,f^i_n)\}_{n=1}^{N^i}\]</span> called <em>order events</em> where</p>
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(i \in \mathbb{N}\)</span> is an <em>unique order identification</em>,</li>
<li><span class="math inline">\(n \in \{1, \ldots, N^i\}\)</span> is an <em>order event number</em>,</li>
<li><span class="math inline">\(t^i_n \in \mathbb{R}_{&gt;0}\)</span> is an <em>event timestamp</em>, <span class="math inline">\(\forall n: t^i_n &lt; t^i_{n+1}\)</span>,</li>
<li><span class="math inline">\(e^i_n \in \{0, 1\}\)</span> is a <em>event type</em>; <span class="math inline">\(e^i_n = 1\)</span> is an <em>activation</em> event, <span class="math inline">\(e^i_n = 0\)</span> is an <em>deactivation</em> event,</li>
<li><span class="math inline">\(e^i_1 = 1\)</span> and <span class="math inline">\(\forall n \in \{2, \ldots, N^i\} : e^i_n = 0 \implies e^i_{n-1} = 1\)</span>,</li>
<li><span class="math inline">\(p_n^i \in \mathbb{R}_{&gt;0}\)</span> is an <em>order price</em>,</li>
<li><span class="math inline">\(v_n^i \in \mathbb{R}\)</span> is an <em>order volume</em>,</li>
<li><span class="math inline">\(\forall n_1, n_2: \text{sgn}(v_{n_1}^i) = \text{sgn}(v_{n_2}^i)\)</span>,</li>
<li><span class="math inline">\(f^i_n \in \{0, 1\}\)</span> is a <em>fill indicator</em>; <span class="math inline">\(f^i_n = 1\)</span> indicates that the volume is changed due to fill.
</div></li>
</ol>
<p>We say that an order <span class="math inline">\(i\)</span> event <span class="math inline">\(n\)</span> with <span class="math inline">\(e^i_n = 1\)</span> is an <em>activation</em> event in a sense that after the event <span class="math inline">\(n\)</span> order <span class="math inline">\(i\)</span> is <em>active</em>, i.e. represents a commitment to buy or sell given volume <span class="math inline">\(v_n^i\)</span> of an asset at no worse than a price <span class="math inline">\(p^i_n\)</span>. If <span class="math inline">\(b^i_n = 1\)</span> then the commitment is valid at <span class="math inline">\(t_n^i\)</span> and afterwards. If <span class="math inline">\(b^i_n = 0\)</span> then the commitment is valid after <span class="math inline">\(t_n^i\)</span>.</p>
<p>Similarly, we say that an event <span class="math inline">\(m\)</span> with <span class="math inline">\(e^i_m = 0\)</span> is a <em>deactivation</em> event in a sense that it indicates the last moment when the commitment to buy or sell <span class="math inline">\(v^i_m\)</span> at no worse than <span class="math inline">\(p^i_m\)</span> is still valid. If <span class="math inline">\(b^i_m = 1\)</span> then the commitment is valid at <span class="math inline">\(t_m^i\)</span> and not valid afterwards. If <span class="math inline">\(b^i_m = 0\)</span> then the commitment is valid before <span class="math inline">\(t_m^i\)</span> and not valid at <span class="math inline">\(t_m^i\)</span> and afterwards.</p>

<div class="theorem">
<p><span id="thm:equivalence" class="theorem"><strong>Theorem 2.1  </strong></span>There is one-to-one correspondance between orders as defined by <a href="reconstruction-algorithm.html#def:order">2.7</a> and order tables as defined by <a href="reconstruction-algorithm.html#def:order-table">2.11</a>.</p>
</div>

</div>
<div id="limit-order-book-lob" class="section level2">
<h2><span class="header-section-number">2.3</span> Limit Order Book (LOB)</h2>
<p>Typically the term <a href="https://www.investopedia.com/terms/o/order-book.asp">order book</a> refers to an electronic list of buy and sell orders for a specific security or financial instrument organized by price level. An order book lists the number of shares being bid on or offered at each price point, or market depth. Order books are used by almost every exchange to list the orders for different securities.</p>

<div class="definition">
<span id="def:order-book" class="definition"><strong>Definition 2.12  (Order Book)  </strong></span>A set of orders with common resolution parameters <span class="math inline">\(v_0\)</span> and <span class="math inline">\(\vartheta\)</span> <span class="math inline">\(\mathcal{O} = \{o^i(t)\}_i\)</span> where <span class="math inline">\(o^i(t)\)</span> is defined by <a href="reconstruction-algorithm.html#def:order">2.7</a> is called an <em>order book</em>. A (possibly empty) subset <span class="math inline">\(\mathcal{B} =\{o^b(t)\}_{v_k^b &gt; 0} \subset \mathcal{O}\)</span> of buy orders is called <em>bids</em> and a (possibly empty) subset <span class="math inline">\(\mathcal{A} =\{o^a(t)\}_{v_k^a &lt; 0} \subset \mathcal{O}\)</span> of sell orders is called <em>asks</em>.
</div>

<p>From definition of an order <a href="reconstruction-algorithm.html#def:order">2.7</a> follows that <span class="math inline">\(\mathcal{O} = \mathcal{A} \cup \mathcal{B}\)</span> and <span class="math inline">\(\mathcal{A} \cap \mathcal{B} = \emptyset\)</span>.</p>

<div class="definition">
<span id="def:best-bid-price" class="definition"><strong>Definition 2.13  (Best Bid Price)  </strong></span>Suppose an order book <span class="math inline">\(\mathcal{O}\)</span> is given. The function <span class="math inline">\(b(t)\)</span> defined as:
<span class="math display">\[
  b_{\mathcal{O}}(t) = \begin{cases} \max_{o^b(t) \in \mathcal{B}} p^b(t), &amp; \text{ if } \mathcal{B} \neq \emptyset \\0, &amp; \text{ otherwise }  \end{cases}
  \]</span> is called <em>best bid price</em>.
</div>


<div class="definition">
<span id="def:best-ask-price" class="definition"><strong>Definition 2.14  (Best Ask Price)  </strong></span>Suppose an order book <span class="math inline">\(\mathcal{O}\)</span> is given. The function <span class="math inline">\(a(t)\)</span> defined as:
<span class="math display">\[
  a_{\mathcal{O}}(t) = \begin{cases} \min_{o^a(t) \in \mathcal{A}} p^a(t) &amp; \text{ if } \mathcal{A} \neq \emptyset \\ +\infty, &amp; \text{ otherwise } \end{cases}
  \]</span> is called <em>best ask price</em>
</div>


<div class="definition">
<span id="def:spread" class="definition"><strong>Definition 2.15  (Spread)  </strong></span>Suppose an order book <span class="math inline">\(\mathcal{O}\)</span> is given and <span class="math inline">\(a_{\mathcal{O}}(t)\)</span> and <span class="math inline">\(b_{\mathcal{O}}(t)\)</span> are its best ask price and best bid price functions as defined by <a href="reconstruction-algorithm.html#def:best-ask-price">2.14</a> and <a href="reconstruction-algorithm.html#def:best-bid-price">2.13</a> respectively. Then the function <span class="math display">\[
  s_{\mathcal{O}}(t) = a_{\mathcal{O}}(t) -  b_{\mathcal{O}}(t) 
  \]</span> is called <em>spread</em>.
</div>


<div class="definition">
<span id="def:lob" class="definition"><strong>Definition 2.16  (Limit Order Book)  </strong></span>Suppose an order book <span class="math inline">\(\mathcal{L}\)</span> as defined by <a href="reconstruction-algorithm.html#def:order-book">2.12</a> is given. Then <span class="math inline">\(\mathcal{L}\)</span> is called a <em>Limit Order Book (LOB)</em> if its spread function as defined by <a href="reconstruction-algorithm.html#def:spread">2.15</a> is always positive:
<span class="math display">\[ 
  \forall t: s_{\mathcal{L}}(t) &gt; 0
\]</span>
</div>

<p>A <a href="https://www.investopedia.com/terms/m/marketorder.asp">market order</a> is a request by an investor to buy or sell a security at the best available price at the time of order placement. The request is usually made through a broker or brokerage service and is ultimately executed by an exchange that maintains an order book. Clearly, a market order cause an exchange’s order book to be updated so market orders are modeled as <em>changes</em> of an order book.</p>

<div class="definition">
<p><span id="def:market-buy-order" class="definition"><strong>Definition 2.17  (Market Buy Order)  </strong></span>Suppose a Limit Order Book <span class="math inline">\(\mathcal{L}\)</span> is given and <span class="math inline">\(\mathcal{A} =\{o^a(t)\}_{v_k^a &lt; 0} \subset \mathcal{L}\)</span> as defined by <a href="reconstruction-algorithm.html#def:order">2.7</a> and <a href="reconstruction-algorithm.html#def:lob">2.16</a>. Suppose that at time <span class="math inline">\(t_j\)</span> <span class="math display">\[\sum_{o^a(t) \in \mathcal{A} } f^a(t_j) &lt; 0 \]</span> Then it is said that a <em>market buy order</em> is placed and executed at time <span class="math inline">\(t_j\)</span> for <span class="math inline">\(\sum_{o^a(t) \in \mathcal{A} } |f^a(t_j)p^a(t_j)|\)</span> units of currency.</p>
</div>


<div class="definition">
<p><span id="def:market-sell-order" class="definition"><strong>Definition 2.18  (Market Sell Order)  </strong></span>Suppose a Limit Order Book <span class="math inline">\(\mathcal{L}\)</span> is given and <span class="math inline">\(\mathcal{B} =\{o^b(t)\}_{v_k^b &gt; 0} \subset \mathcal{L}\)</span> as defined by <a href="reconstruction-algorithm.html#def:order">2.7</a> and <a href="reconstruction-algorithm.html#def:lob">2.16</a>. Suppose that at time <span class="math inline">\(t_j\)</span> <span class="math display">\[\sum_{o^b(t) \in \mathcal{B} } f^b(t_j) &gt; 0 \]</span> Then it is said that a <em>market sell order</em> is placed and executed at time <span class="math inline">\(t_j\)</span> for <span class="math inline">\(\sum_{o^b(t) \in \mathcal{B} } f^a(t_j)\)</span> units of asset.</p>
</div>

</div>
<div id="example-of-lob" class="section level2">
<h2><span class="header-section-number">2.4</span> Example of LOB</h2>
<p>To make the above definitions intuitively clear, let’s consider an example. Table <a href="reconstruction-algorithm.html#tab:example-order-table">2.1</a> contains a consolidated order table for six limit orders and figure <a href="reconstruction-algorithm.html#fig:order-life-cycle">2.1</a> shows all possible ways of processing an order by an exchange (though not every exchange supports all operations shown).</p>
<div class="figure" style="text-align: center"><span id="fig:order-life-cycle"></span>
<img src="order-life-cycle.png" alt="All possible ways of processing an order by an exchange." width="455" />
<p class="caption">
Figure 2.1: All possible ways of processing an order by an exchange.
</p>
</div>
<table class="huxtable" style="border-collapse: collapse; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: 0%; margin-right: auto;  ">
<caption style="caption-side: top; text-align: left;"><span id="tab:example-order-table">Table 2.1: </span> The sample order table contains information about six limit orders, three market orders and five trades.</caption><col><col><col><col><col><col><col><col><col><tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 1pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">#</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">\(i\)</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">\(n\)</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">\(t^i_n\)</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">\(e^i_n\)</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">\(p^i_n\)</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">\(v^i_n\)</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">\(f^i_n\)</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 1pt; padding: 4pt 4pt 4pt 4pt;">\(\Delta v^i_n \)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 1pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0000000001</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">13:59:57.2</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">50</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">200</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 1pt; padding: 4pt 4pt 4pt 4pt;"></td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 1pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">2</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0000000002</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">13:59:58.0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">80</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">-200</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 1pt; padding: 4pt 4pt 4pt 4pt;"></td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 1pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">3</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0000000002</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">13:59:58.9</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">80</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">-100</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 1pt; padding: 4pt 4pt 4pt 4pt;">-100</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 1pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">4</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0000000003</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">13:59:59.5</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">25</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">500</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 1pt; padding: 4pt 4pt 4pt 4pt;"></td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 1pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">5</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0000000001</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">14:00:00.0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">50</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">200</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 1pt; padding: 4pt 4pt 4pt 4pt;">200</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 1pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">6</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0000000003</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">14:00:00.0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">25</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">500</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 1pt; padding: 4pt 4pt 4pt 4pt;">500</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 1pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">7</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0000000004</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">14:00:00.0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">25</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">-500</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 1pt; padding: 4pt 4pt 4pt 4pt;"></td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 1pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">8</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0000000005</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">14:00:00.7</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">50</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">-400</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 1pt; padding: 4pt 4pt 4pt 4pt;"></td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 1pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">9</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0000000002</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">3</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">14:00:01.2</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">80</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">-100</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 1pt; padding: 4pt 4pt 4pt 4pt;"></td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 1pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">10</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0000000006</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">14:00:01.7</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">10</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">500</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 1pt; padding: 4pt 4pt 4pt 4pt;"></td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 1pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">11</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0000000004</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">14:00:02.0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">25</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">-500</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 1pt; padding: 4pt 4pt 4pt 4pt;">-500</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 1pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">12</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0000000005</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">14:00:02.0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">50</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">-100</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 1pt; padding: 4pt 4pt 4pt 4pt;">-300</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 1pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">13</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0000000005</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">3</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">14:00:02.4</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">50</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">-100</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 1pt; padding: 4pt 4pt 4pt 4pt;">-100</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 1pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">14</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0000000006</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">14:00:02.4</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">60</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">400</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 1pt; padding: 4pt 4pt 4pt 4pt;">100</td>
</tr>
</table>

<p>Figure <a href="reconstruction-algorithm.html#fig:example-order-book">2.2</a> shows price and volume functions for six limit orders in table <a href="reconstruction-algorithm.html#tab:example-order-table">2.1</a>.</p>
<div class="figure"><span id="fig:example-order-book"></span>
<img src="oberon_files/figure-html/example-order-book-1.png" alt="Price and Volume functions for the limit orders in table \@ref(tab:example-order-table)" width="672" />
<p class="caption">
Figure 2.2: Price and Volume functions for the limit orders in table <a href="reconstruction-algorithm.html#tab:example-order-table">2.1</a>
</p>
</div>
<p>It can bee seen from figure <a href="reconstruction-algorithm.html#fig:example-order-book">2.2</a> that:</p>
<ul>
<li>At 13:59:57.2 order 1 to buy 200 units of the asset at price no worse than 50 per unit has been placed,</li>
<li>At 13:59:58.0 order 2 to sell 200 units of the asset at price no worse than 80 per unit has been placed,</li>
<li>At 13:59:58.9 the volume of order 2 has been amended (reduced by half) by the trader who placed the order,</li>
<li>At 13:59:59.5 order 3 to buy 500 units of the asset at price no worse than 25 per unit has been placed,</li>
<li>At 14:00:00.0 order 4 to sell 500 units of the asset at price no worse than 25 has been placed. Exactly at the same time, a market order has been placed to sell 700 units of the asset and two <em>sell</em> trades has been executed: <span class="math inline">\((\text{13:59:59.5}, 1, 50, 200)\)</span> and <span class="math inline">\((\text{13:59:59.5}, 3, 25, 500)\)</span>. Since the market order and order 4 have been placed at exactly the same time, it is very likely that order 4 has actually been placed to sell 1200 units, partially executed and the reminder (i.e. 500 units) has landed in LOB and there were no market order. Nevertheless fundamentally it is still a combination of a market order and a limit order.</li>
<li>At 14:00:00.7 order 5 to sell 400 units of the asset at price no worse than 50 per unit has been placed,</li>
<li>At 14:00:01.2 order 2 has been cancelled,<br />
</li>
<li>At 14:00:01.7 order 6 to buy 500 units of the asset at price no worse than 10 per unit has been placed,</li>
<li>At 14:00:02.0 a market order to buy the asset for 27500 units of the currency has been placed and two buy trades have been executed: <span class="math inline">\((\text{14:00:02.0}, 4, 25, -500)\)</span> and <span class="math inline">\((\text{14:00:02.0}, 5, 50, -300)\)</span>. Alternatively, it could be a limit order to buy 800 units of the asset at price no worser than 50 that was fully executed.</li>
<li>At 14:00:02.4 volume and price of order 6 have been amended. Its volume has been reduced by 100 units of the asset and its price increased to 60. At the same time a market buy order has been placed for 5000 units of the currency and single trade has been executed: <span class="math inline">\((\text{14:00:02.0}, 5, 50, -100)\)</span>. Most likely the change of price of order 6 has transformed it to a market limit order which was partially executed and the reminder was placed in the order book again.</li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="results.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
